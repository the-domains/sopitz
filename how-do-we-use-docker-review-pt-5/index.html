<!DOCTYPE html>
<html dir="ltr" lang="en"><head><title>How do we use Docker? (Review Pt. 5)</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta http-equiv="content-type" content="text/html; charset=utf-8" />
  <meta name="generator" content="The Grid the-composer/ds-d4/1.1.13">
  <meta name="the-grid-solution" content="b36f1e48-f2eb-4d21-9ae0-0dbee282f186">
  <script src="https://ajax.googleapis.com/ajax/libs/webfont/1.6.16/webfont.js"></script>
  <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/babel-polyfill/6.9.1/polyfill.js"></script>
  <link rel="stylesheet" href="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/styles/css/style.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/styles/css/animations.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/styles/css/props.css" type="text/css" />
  <link rel="stylesheet" href="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/styles/css/focalpoint.css" type="text/css" />
  <style id="web-font-binder" type="text/css">html { font-family: '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } html.wf-active { font-family: 'Inconsolata', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } .wf-active .font-title, .wf-active .font-headline, .wf-active .font-h1, .wf-active .font-h2, .wf-active .font-h3 { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 700; } .wf-active .font-subtitle, .wf-active .font-h4, .wf-active .font-h5, .wf-active .font-h6 { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } .wf-active .font-text, .wf-active .font-list { font-family: 'Inconsolata', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif'; } .wf-active .font-quote { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400;font-style: italic; } .wf-active .font-cta { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif'; }</style><link rel="icon" href="https://the-grid-user-content.s3-us-west-2.amazonaws.com/50d74ad9-19be-46ed-b7cb-955fdcb544c3.png"/><link rel="alternate" type="application/rss+xml" title="RSS" href="./rss.xml"/></head><body><div id="app"><div id="wrapper" class="System color-bg Brockmann section-h-padding-small section-v-padding-small hero-transition-none m-t-0 p-l-3 ls-p-l-4  colors-light colors-global " data-reactroot="" data-reactid="1" data-react-checksum="1686624678"><!-- react-empty: 2 --><section id="NavLeftColumn" class="Section Section--components-1 Section--nav color-box h-fs w-3rem ms-w-4rem title-size-medium bx-sh-soft  colors-light colors-global " data-reactid="3"><div class="Component Nav--hamburger h-fs l--05rem ms-l-0 pos-r" data-reactid="4"><div class="Site-title color-text-pop pos-a rot-90 t-o-bl w-100vh z-20 m-t-1 l-1rem t-5rem" data-reactid="5"><span class="f-s-ms w-s-nw font-title" data-reactid="6"><a href="index.html" data-reactid="7">uminoso Consultingl</a></span></div><a href="index.html" class="l-1rem t-4rem pos-a z-20" data-reactid="8"><img src="https://the-grid-user-content.s3-us-west-2.amazonaws.com/d10021f9-652c-4314-954b-0d6c5db83590.png" class="w-2rem" data-reactid="9"/></a><!-- react-empty: 10 --><!-- react-text: 11 --><!-- /react-text --></div></section><div class="Items min-h-80vh" data-reactid="12"><section id="section-ArticleSiteHeaderFallback-header-item-0" class="Section Section--components-1 color-title title-size-medium p-0 color-bg text-align-center  colors-dark colors-global " data-reactid="13"><div class="Component p-0 p-h-1 " data-reactid="14"><div class="Group Group--column min-w-240px p-1 m-a" data-reactid="15"><!-- react-empty: 16 --><!-- react-empty: 17 --><h4 class="font-title" data-reactid="18">Shining a light in IT</h4></div></div></section><section id="section-ArticleHero-25d49f46-3619-4d21-bdc8-be453c3b3bcc" class="Section Section--components-1 no-padding p-0 w-100p color-bg color-title d-b Section--article title-size-large section-bgcover-and text-align-center  colors-dark colors-local " data-reactid="19"><div class="Component p-1" data-reactid="20"><div class="Bg color-box-pop-2 op-30" data-reactid="21"><div class="Cover ov-h " data-reactid="22"><picture class="min-h-80px" data-reactid="23"><source media="(min-width: 1440px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/1855025d94e6b062577136e4ed47eb08/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=1400" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="24"/><source media="(min-width: 1280px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/7b8acf6b751ece59d4020b0cd489366f/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=1280" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="25"/><source media="(min-width: 720px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/d5cbfa25b8dda054883a3492412d365a/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=720" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="26"/><source media="(min-width: 360px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/6bdf1139ad497e8affe2937b9aff0cfb/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=360" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="27"/><img class="color-loading" data-width="1400" data-height="621" data-ratio="2.254428341384863" src="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/1855025d94e6b062577136e4ed47eb08/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=1400" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="28"/></picture></div></div><div class="Group Group--graphical p-1 w-100p ms-w-20p l-0rem ms-l-3rem pos-r ms-pos-f v-a-t" data-reactid="29"><div class="Cover ov-h " data-reactid="30"><picture class="min-h-80px" data-reactid="31"><source media="(min-width: 1440px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/1855025d94e6b062577136e4ed47eb08/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=1400" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="32"/><source media="(min-width: 1280px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/7b8acf6b751ece59d4020b0cd489366f/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=1280" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="33"/><source media="(min-width: 720px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/d5cbfa25b8dda054883a3492412d365a/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=720" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="34"/><source media="(min-width: 360px)" srcset="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/6bdf1139ad497e8affe2937b9aff0cfb/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=360" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="35"/><img class="color-loading" data-width="1400" data-height="621" data-ratio="2.254428341384863" src="https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/1855025d94e6b062577136e4ed47eb08/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&amp;width=1400" style="object-position:92.87109375% 89.60472020933977%;" data-reactid="36"/></picture></div></div><div class="Group Group--meta p-1 color-text ms-pos-f min-w-240px w-100p ms-w-20p ms-r-3rem d-ib " data-reactid="37"><!-- react-empty: 38 --><div class="Attribution op-70 font-title " data-reactid="39"><h5 data-reactid="40"><span class="Author f-s-xxs " data-reactid="41"><span>Simon Opitz</span></span></h5></div></div><div class="Group Group--column min-w-240px p-1 color-title v-a-t d-b m-a w-100p ms-w-50p" data-reactid="42"><div class="System-font " data-reactid="43"><h2 data-reactid="44"><span data-reactid="45"><span class="font-title" data-reactid="46">How do we use Docker? (Review Pt. 5)</span></span></h2></div><!-- react-empty: 47 --></div></div><article id="article-section-ArticleHero-25d49f46-3619-4d21-bdc8-be453c3b3bcc" class="Component color-text p-1 t-a-l" data-reactid="48"><div class="Content Dropcap" data-reactid="49"><p>We at [eForce21](<a href="http://www.eforce21.com" target="_blank" rel="noopener noreferrer">eforce21.com</a>) use Docker in various customer projects as well as for our own infrastructure. I want to give you some real life `Dockerfile`s and `docker-compose.yml`s that give you an idea of what you can do with docker. Hint: not all of those examples will automatically work out of the box for you guys because some of the `Dockerfiles` cannot be published due to NDAs and confidentiality concerns. But please just leave me a comment or a tweet at [<a href="https://twitter.com/_sopitz" target="_blank" rel="noopener noreferrer">@_sopitz</a>](<a href="https://twitter.com/_sopitz" target="_blank" rel="noopener noreferrer">twitter.com/_sopitz</a>). I'm happy to help.</p><p># jwilder/nginx-proxy<br>[That's](<a href="https://github.com/jwilder/nginx-proxy" target="_blank" rel="noopener noreferrer">github.com/jwilder/nginx-proxy</a>) our magical tool. We reverse proxy all our applications on our servers for domain-name, ssl and access management. It will basically do everything for you. You will map the docker socket into the container and it listens for new containers, stopped containers and will perform all the actions necessary to make you happy. Our `Dockerfile` looks like this:</p><p>&lt;pre&gt;<br>FROM jwilder/nginx-proxy</p><p>COPY config/vhosts/* /etc/nginx/vhost.d/<br>COPY config/global/* /etc/nginx/conf.d/<br>&lt;/pre&gt;</p><p>There is a file in `config/global/` called `proxy.conf` where we've defined a couple of settings that should be applied for all vhosts. E. g. `client_max_body_size 0;` to make sure we can pull and push bigger files to our GitLab or docker-registry.<br>`config/vhosts/` contains files that resemble the name of your vhost (e. g. <a href="http://simonopitz.me" target="_blank" rel="noopener noreferrer">simonopitz.me</a> for this domain). You can specify settings for a single vhost with these files. When you build the `Dockerfile` all your vhosts will be configured accordingly during the container build. Once the containers are started you will automatically get your vhost-configs generated by jwilders nginx-proxy.</p><p># Build-Server<br>We have completely automated the setup of our build server. As we keep all our configurations in a git repository all we have to do is a check out on a machine, run a shell script and the whole server is configured. Even the Jenkins Jobs are put in place correctly and work out of the box. Here is what the structure looks like:<br>![](/content/images/2015/12/docker-usage-eforce-structure3.png)</p><p>The <a href="http://setup.sh" target="_blank" rel="noopener noreferrer">setup.sh</a> basically does all we need. It collects paths for volumes and all settings, builds images, runs all containers and pushes everything to our registry. But have a look yourself:<br>&lt;pre&gt;<br>#/bin/bash -e<br>. settings/containers.rc<br>. settings/images.rc<br>. settings/volumes.rc</p><p>OPTIND=1<br>default="false"<br>while getopts "d?" opt; do<br> case "$opt" in<br> d ) default="true"<br> ;;<br> esac<br>done</p><p>shift $((OPTIND-1))</p><p>[ "$1" = "--" ] &amp;&amp; shift</p><p># ask for setting input if not started with -d<br>if [ "$default" != "true" ]; then<br> lines=$(cat settings/volumes.rc)<br> for line in $lines<br> do<br> value=${line#*=}<br> variable=${line%%=*}<br> printf "$variable [$value] "<br> read answer<br> if [ "$answer" == "" ]; then<br> echo "$variable=$value" &gt;&gt; settings/volumes.rc.tmp<br> else<br> echo "$variable=$answer" &gt;&gt; settings/volumes.rc.tmp<br> fi<br> done<br> cp settings/volumes.rc settings/volumes.rc.previous<br> mv settings/volumes.rc.tmp settings/volumes.rc<br>fi</p><p># export settings for envsusbt<br>lines=$(cat settings/volumes.rc)<br>for line in $lines<br>do<br> export $line<br>done</p><p># build images<br>echo "[info] Building Image: ${IMAGE_NGINX_PROXY}"<br>docker build -t ${IMAGE_NGINX_PROXY} nginx-proxy</p><p>echo "[info] Building Image: ${IMAGE_SONAR_POSTGRES}"<br>docker build -t ${IMAGE_SONAR_POSTGRES} sonarqube/postgres</p><p>echo "[info] Building Image: ${IMAGE_SONARQUBE}"<br>docker build -t ${IMAGE_SONARQUBE} sonarqube/sonarqube</p><p>echo "[info] Building Image: ${IMAGE_ARTIFACTORY}"<br>docker build -t ${IMAGE_ARTIFACTORY} artifactory</p><p>echo "[info] Building Image: ${IMAGE_JENKINS}"<br>docker build -t ${IMAGE_JENKINS} jenkins</p><p># replace variables in docker-compose file<br>cp docker-compose.yml docker-compose.yml.template<br>envsubst &lt; docker-compose.yml &gt; docker-compose.yml.tmp<br>mv docker-compose.yml.tmp docker-compose.yml<br># start infrastructure<br>docker-compose up -d<br># move defaults and backups into place<br>echo "[info] backing up docker-compose.yml of this run to docker-compose.yml.previous"<br>cp docker-compose.yml docker-compose.yml.previous<br>mv docker-compose.yml.template docker-compose.yml</p><p># push images to registry<br>echo "[info] Pushing Image: ${IMAGE_NGINX_PROXY}"<br>docker push ${IMAGE_NGINX_PROXY}</p><p>echo "[info] Pushing Image: ${IMAGE_SONAR_POSTGRES}"<br>docker push ${IMAGE_SONAR_POSTGRES}</p><p>echo "[info] Pushing Image: ${IMAGE_SONARCUBE}"<br>docker push ${IMAGE_SONARCUBE}</p><p>echo "[info] Pushing Image: ${IMAGE_JENKINS}"<br>docker push ${IMAGE_JENKINS}</p><p>echo "[info] Pushing Image: ${IMAGE_ARTIFACTORY}"<br>docker push ${IMAGE_ARTIFACTORY}<br>&lt;/pre&gt;</p><p>You can look into the rest [here](<a href="https://simonopitz.me/content/images/2015/infrastructure.zip" target="_blank" rel="noopener noreferrer">simonopitz.me/content/images/2015/infrastructure.zip</a>). I've packaged up all the whole scripts and stuff to get your build server up and running with just a few tweaks. Need help? Just tweet me at [<a href="https://twitter.com/_sopitz" target="_blank" rel="noopener noreferrer">@_sopitz</a>](<a href="https://twitter.com/_sopitz" target="_blank" rel="noopener noreferrer">twitter.com/_sopitz</a>). We at [eForce21](<a href="http://www.eforce21.com" target="_blank" rel="noopener noreferrer">eforce21.com</a>) love to help you.</p><p># Gitlab with Google OAuth<br>That's what you need to do to get a Gitlab running with OAuth from Google.</p><p>* Login to your [Google Developer Console](<a href="https://console.developers.google.com/" target="_blank" rel="noopener noreferrer">console.developers.google.com</a>) <br>* create a new project, e. g. gitlab<br>* configure the OAuth screen (APIs and authentication)<br>* generate login data<br>* configure Google-API</p><p>I guess you want to secure the traffic to your Gitlab via SSL.</p><p>&lt;pre&gt;<br>mkdir -p /etc/nginx/ssl<br>cd /etc/nginx/ssl<br>openssl genrsa -out your_domain.key 2048<br>openssl req -new -x509 -key your_domain.key -out your_domain.crt -days 1095<br>&lt;/pre&gt;</p><p>You can also get a certificate from [Let's encrypt](<a href="http://letsencrypt.org" target="_blank" rel="noopener noreferrer">letsencrypt.org</a>). Let's Encrypt certificate handling will be covered by a blog post over at the [eForce21 Blog](<a href="http://www.eforce21.com/blog/" target="_blank" rel="noopener noreferrer">eforce21.com/blog</a>).</p><p>If you haven't started your nginx-proxy already with the setup I posted earlier, you should do that now.</p><p>&lt;pre&gt;<br>docker run -d -v /etc/nginx/certs:/etc/nginx/certs -v /var/run/docker.sock:/tmp/docker.sock --security-opt=label:type:docker_t -p 80:80 -p 443:443 --name nginx-proxy jwilder/nginx-proxy<br>&lt;/pre&gt;</p><p>You only need one reverse proxy per IP. It will create name based virtual hosts for you and distribute the traffic to the appropriate applications.</p><p>Now we need to start Gitlab itself. We use `docker-compose`for this:<br>&lt;pre&gt;<br>postgresql:<br> image: sameersbn/postgresql:9.4-3<br> environment:<br> - DB_USER=gitlab_user<br> - DB_PASS=gitlab_password<br> - DB_NAME=gitlabdb<br> volumes:<br> - /var/lib/docker-data/gitlab/postgresql:/var/lib/postgresql<br>gitlab:<br> image: sameersbn/gitlab:7.14.1<br> links:<br> - redis:redisio<br> - postgresql:postgresql<br> ports:<br> - "2222:22”<br> environment:<br> - TZ=Europe/Berlin<br> - GITLAB_TIMEZONE=Berlin<br> - GITLAB_HTTPS=true<br> - GITLAB_HOST=your_host<br> - GITLAB_PORT=443<br> - GITLAB_SSH_PORT=2222<br> - GITLAB_EMAIL=your_email<br> - GITLAB_EMAIL_REPLY_TO=your_email<br> - VIRTUAL_HOST=<a href="http://git.dev.eforce21.com" target="_blank" rel="noopener noreferrer">git.dev.eforce21.com</a><br> - OAUTH_GOOGLE_API_KEY=client_id<br> - OAUTH_GOOGLE_APP_SECRET=client_key<br> - OAUTH_GOOGLE_RESTRICT_DOMAIN=restrict_domain<br> - OAUTH_ALLOW_SSO=true<br> - OAUTH_BLOCK_AUTO_CREATED_USERS=false<br> volumes:<br> - /var/lib/docker-data/gitlab/gitlab:/home/git/data<br>redis:<br> image: sameersbn/redis:latest<br> volumes:<br> - /var/lib/docker-data/gitlab/redis:/var/lib/redis<br>&lt;/pre&gt;</p><p>And then start it with `docker-compose up -d`. Once it's started you can log in with the admin: root:5iveL!fe<br>You will have to change that password after login.</p><p># phensley/docker-dns<br>That's what we sometimes use when we cannot use `docker-compose`. It will help you to achieve a name based linking system via DNS. Docker will only allow an IP based linking and that has proven to be not flexible enough at times. You will always have to restart more containers than necessary for your update and get that running with phensleys docker-dns container will make more complex setups without `docker-compose` very flexible.</p><p>Any comments or need help? Just tweet me at [<a href="https://twitter.com/_sopitz" target="_blank" rel="noopener noreferrer">@_sopitz</a>](<a href="https://twitter.com/_sopitz" target="_blank" rel="noopener noreferrer">twitter.com/_sopitz</a>). We at [eForce21](<a href="http://www.eforce21.com" target="_blank" rel="noopener noreferrer">eforce21.com</a>) love to help you.</p></div></article></section></div><section id="Footer3col" class="Section Section--components-2 Section--footer color-bg color-title z-30 p-1 ms-p-h-2vw  colors-dark colors-global " data-reactid="50"><div class="fx-1 bd-none ms-bd-r ms-bd-w-1" data-reactid="51"><div class="Group Group-heading ms-p-r-4" data-reactid="52"><div class="Site-title color-text-pop" data-reactid="53"><span data-reactid="54"><a href="index.html" class="m-r-1 m-b-1 v-a-m d-ib" data-reactid="55"><img src="https://the-grid-user-content.s3-us-west-2.amazonaws.com/d10021f9-652c-4314-954b-0d6c5db83590.png" class="h-2rem w-a" data-reactid="56"/></a><h2 class="font-title" data-reactid="57"><a href="index.html" data-reactid="58">How do we use Docker? (Review Pt. 5)</a></h2></span></div></div></div><div class="fx-1" data-reactid="59"><div class="Group Group--links" data-reactid="60"><div class="Group Group--links f-s-m ms-f-s-s w-s-wrap ms-w-s-nowrap" data-reactid="61"><div class="Link" data-reactid="62"><a data-reactid="63"></a></div></div></div></div></section></div></div>
    <script src="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/scripts/placeholder.js"></script>
    <script src="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/scripts/hero-transition.js"></script>
    <script src="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/scripts/slider.js"></script>
  <script src="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/assets/scripts/navLeft.js"></script><script id="pageReactInitState">window.pageReactInitState = {"items":{"site-navigation-item":{"id":"site-navigation-item","index":0,"metadata":{"@type":"navigation","starred":true},"content":[{"id":"site-navigation-block","type":"navigation","_html":"","metadata":{"starred":true},"navigation":[{"href":"index.html","title":"Shining a light in IT","rel":"home","type":"MainPage"}]}]},"header-item-0":{"id":"header-item-0","index":1,"metadata":{"@type":"header","starred":true},"content":[{"id":"cta-title-1","type":"h1","_text":"Shining a light in IT","_html":"<h1>Shining a light in IT</h1>","metadata":{"starred":true}}]},"25d49f46-3619-4d21-bdc8-be453c3b3bcc":{"id":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","index":2,"created_by":"f64ca813-26db-43f6-bc7f-f5457803101a","updated_by":"f64ca813-26db-43f6-bc7f-f5457803101a","created_at":"2016-08-03T15:14:19.672Z","updated_at":"2016-08-03T15:17:05.592Z","published":true,"score":0,"path":"_posts/2016-08-03-how-do-we-use-docker-review-pt-5.md","_title":"How do we use Docker? (Review Pt. 5)","metadata":{"@type":"MediaObject","url":"how-do-we-use-docker-review-pt-5/index.html","starred":false,"hasPage":true,"_description":"We at [eForce21](http://www.eforce21.com) use Docker in various customer projects as well as for our own infrastructure. I want to give you some real life `Dockerfile`s and `docker-compose.yml`s that give you an idea of what you can do with docker. Hint: not all of those examples will automatically work out of the box for you guys because some of the `Dockerfiles` cannot be published due to NDAs and confidentiality concerns. But please just leave me a comment or a tweet at [@_sopitz](https://twitter.com/_sopitz). I'm happy to help.","title":"How do we use Docker? (Review Pt. 5)","via":{"url":"https://simonopitz.me"},"publisher":{"name":"Simon Opitz"}},"content":[{"id":"b5cdcbab-de15-40d5-971f-81209efdb10a","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"image","created_at":"2016-08-03T15:15:40.484Z","updated_at":"2016-08-03T15:17:05.592Z","_html":"<img src=\"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/0507d28f674bb3adc540eedb888c0cb8/croprotate.png?cropheight=621&cropwidth=1400&degrees=0&input=https%3A%2F%2Fthe-grid-user-content.s3-us-west-2.amazonaws.com%2F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png&x=0&y=40\">","metadata":{"@type":"Article","isBasedOnUrl":"https://the-grid-user-content.s3-us-west-2.amazonaws.com/2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png","starred":true,"_description":"","via":null,"publisher":{"name":"Simon Opitz"}},"cover":{"src":"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/1855025d94e6b062577136e4ed47eb08/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&width=1400","original":"https://the-grid-user-content.s3-us-west-2.amazonaws.com/2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png","imgflosrc":"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/0507d28f674bb3adc540eedb888c0cb8/croprotate.png?cropheight=621&cropwidth=1400&degrees=0&input=https%3A%2F%2Fthe-grid-user-content.s3-us-west-2.amazonaws.com%2F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png&x=0&y=40","resized":"http://the-grid-user-content.s3-us-west-2.amazonaws.com/caliper-resized/893a0619aaa83da366ff5a7f7e8deb13.png","ratio":"512:227","aspect":2.2555066079295156,"orientation":"landscape","width":1400,"height":621,"rotation":0,"animated":false,"pictureImgfloUrls":[{"width":1440,"src":"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/1855025d94e6b062577136e4ed47eb08/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&width=1400"},{"width":1280,"src":"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/7b8acf6b751ece59d4020b0cd489366f/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&width=1280"},{"width":720,"src":"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/d5cbfa25b8dda054883a3492412d365a/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&width=720"},{"width":360,"src":"https://imgflo.herokuapp.com/graph/vahj1ThiexotieMo/6bdf1139ad497e8affe2937b9aff0cfb/insta_hefe.png?input=https%3A%2F%2Fimgflo.herokuapp.com%2Fgraph%2Fvahj1ThiexotieMo%2F0507d28f674bb3adc540eedb888c0cb8%2Fcroprotate.png%3Fcropheight%3D621%26cropwidth%3D1400%26degrees%3D0%26input%3Dhttps%253A%252F%252Fthe-grid-user-content.s3-us-west-2.amazonaws.com%252F2a24c345-a51e-4cd8-b985-11f31d1b2e3c.png%26x%3D0%26y%3D40&width=360"}],"faces":[{"x":1282.421875,"y":538.671875,"width":35.546875,"height":35.546875,"confidence":5.017985},{"x":151.7578125,"y":41.015625,"width":164.0625,"height":164.0625,"confidence":5.011877}],"colors":[[255,255,255],[36,46,55],[58,154,195],[197,78,64],[223,182,73]],"saliency":{"bounding_rect":[[259.765625,35.546875],[1327.5390625,619.3359375]],"confidence":0.567041,"center":[552.34375,449.8046875],"radius":305.197265625},"exif":{"exif":{}}}},{"id":"5977f43a-866e-4ca7-a088-c29341944154","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"h2","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"How do we use Docker? (Review Pt. 5)","_html":"<h2>How do we use Docker? (Review Pt. 5)</h2>","metadata":{"starred":true}},{"id":"58f7b22a-c3a2-4cd8-8911-e3aeb27dc867","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"We at [eForce21](http://www.eforce21.com) use Docker in various customer projects as well as for our own infrastructure. I want to give you some real life `Dockerfile`s and `docker-compose.yml`s that give you an idea of what you can do with docker. Hint: not all of those examples will automatically work out of the box for you guys because some of the `Dockerfiles` cannot be published due to NDAs and confidentiality concerns. But please just leave me a comment or a tweet at [@_sopitz](https://twitter.com/_sopitz). I'm happy to help.","_html":"<p>We at [eForce21](http://www.eforce21.com) use Docker in various customer projects as well as for our own infrastructure. I want to give you some real life `Dockerfile`s and `docker-compose.yml`s that give you an idea of what you can do with docker. Hint: not all of those examples will automatically work out of the box for you guys because some of the `Dockerfiles` cannot be published due to NDAs and confidentiality concerns. But please just leave me a comment or a tweet at [@_sopitz](https://twitter.com/_sopitz). I'm happy to help.</p>","metadata":{"starred":true}},{"id":"62e15d28-7398-4760-aaad-310163a64ec2","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# jwilder/nginx-proxy[That's](https://github.com/jwilder/nginx-proxy) our magical tool. We reverse proxy all our applications on our servers for domain-name, ssl and access management. It will basically do everything for you. You will map the docker socket into the container and it listens for new containers, stopped containers and will perform all the actions necessary to make you happy. Our `Dockerfile` looks like this:","_html":"<p># jwilder/nginx-proxy<br>[That's](https://github.com/jwilder/nginx-proxy) our magical tool. We reverse proxy all our applications on our servers for domain-name, ssl and access management. It will basically do everything for you. You will map the docker socket into the container and it listens for new containers, stopped containers and will perform all the actions necessary to make you happy. Our `Dockerfile` looks like this:</p>","metadata":{"starred":true}},{"id":"d5ee855f-673c-4da8-b78c-0cd0a5299575","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"<pre>FROM jwilder/nginx-proxy","_html":"<p>&lt;pre&gt;<br>FROM jwilder/nginx-proxy</p>","metadata":{"starred":true}},{"id":"4ffffd2f-cf27-403c-ba98-2a88fbef2c68","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"COPY config/vhosts/* /etc/nginx/vhost.d/COPY config/global/* /etc/nginx/conf.d/</pre>","_html":"<p>COPY config/vhosts/* /etc/nginx/vhost.d/<br>COPY config/global/* /etc/nginx/conf.d/<br>&lt;/pre&gt;</p>","metadata":{"starred":true}},{"id":"9b4a9bb8-ef11-465e-90d5-3729c3016209","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"There is a file in `config/global/` called `proxy.conf` where we've defined a couple of settings that should be applied for all vhosts. E. g. `client_max_body_size 0;` to make sure we can pull and push bigger files to our GitLab or docker-registry.`config/vhosts/` contains files that resemble the name of your vhost (e. g. simonopitz.me for this domain). You can specify settings for a single vhost with these files. When you build the `Dockerfile` all your vhosts will be configured accordingly during the container build. Once the containers are started you will automatically get your vhost-configs generated by jwilders nginx-proxy.","_html":"<p>There is a file in `config/global/` called `proxy.conf` where we've defined a couple of settings that should be applied for all vhosts. E. g. `client_max_body_size 0;` to make sure we can pull and push bigger files to our GitLab or docker-registry.<br>`config/vhosts/` contains files that resemble the name of your vhost (e. g. simonopitz.me for this domain). You can specify settings for a single vhost with these files. When you build the `Dockerfile` all your vhosts will be configured accordingly during the container build. Once the containers are started you will automatically get your vhost-configs generated by jwilders nginx-proxy.</p>","metadata":{"starred":true}},{"id":"5e17cf92-6b13-4b5b-86fb-4397aab573bc","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# Build-ServerWe have completely automated the setup of our build server. As we keep all our configurations in a git repository all we have to do is a check out on a machine, run a shell script and the whole server is configured. Even the Jenkins Jobs are put in place correctly and work out of the box. Here is what the structure looks like:![](/content/images/2015/12/docker-usage-eforce-structure3.png)","_html":"<p># Build-Server<br>We have completely automated the setup of our build server. As we keep all our configurations in a git repository all we have to do is a check out on a machine, run a shell script and the whole server is configured. Even the Jenkins Jobs are put in place correctly and work out of the box. Here is what the structure looks like:<br>![](/content/images/2015/12/docker-usage-eforce-structure3.png)</p>","metadata":{"starred":true}},{"id":"c64896cf-5677-4873-a229-174b98c5bec3","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"The setup.sh basically does all we need. It collects paths for volumes and all settings, builds images, runs all containers and pushes everything to our registry. But have a look yourself:<pre>#/bin/bash -e. settings/containers.rc. settings/images.rc. settings/volumes.rc","_html":"<p>The setup.sh basically does all we need. It collects paths for volumes and all settings, builds images, runs all containers and pushes everything to our registry. But have a look yourself:<br>&lt;pre&gt;<br>#/bin/bash -e<br>. settings/containers.rc<br>. settings/images.rc<br>. settings/volumes.rc</p>","metadata":{"starred":true}},{"id":"9e604a46-d2aa-46b7-b9f6-0925ce46a58b","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"OPTIND=1default=\"false\"while getopts \"d?\" opt; do case \"$opt\" in d ) default=\"true\" ;; esacdone","_html":"<p>OPTIND=1<br>default=\"false\"<br>while getopts \"d?\" opt; do<br> case \"$opt\" in<br> d ) default=\"true\"<br> ;;<br> esac<br>done</p>","metadata":{"starred":true}},{"id":"f372b462-76fb-441f-a6d0-00e02f70faf8","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"shift $((OPTIND-1))","_html":"<p>shift $((OPTIND-1))</p>","metadata":{"starred":true}},{"id":"9d1b12a7-4f1c-4b0e-b639-36de42505856","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"[ \"$1\" = \"--\" ] && shift","_html":"<p>[ \"$1\" = \"--\" ] &amp;&amp; shift</p>","metadata":{"starred":true}},{"id":"72cbe7d4-7e0b-4e43-a177-74847477bac6","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# ask for setting input if not started with -dif [ \"$default\" != \"true\" ]; then lines=$(cat settings/volumes.rc) for line in $lines do value=${line#*=} variable=${line%%=*} printf \"$variable [$value] \" read answer if [ \"$answer\" == \"\" ]; then echo \"$variable=$value\" >> settings/volumes.rc.tmp else echo \"$variable=$answer\" >> settings/volumes.rc.tmp fi done cp settings/volumes.rc settings/volumes.rc.previous mv settings/volumes.rc.tmp settings/volumes.rcfi","_html":"<p># ask for setting input if not started with -d<br>if [ \"$default\" != \"true\" ]; then<br> lines=$(cat settings/volumes.rc)<br> for line in $lines<br> do<br> value=${line#*=}<br> variable=${line%%=*}<br> printf \"$variable [$value] \"<br> read answer<br> if [ \"$answer\" == \"\" ]; then<br> echo \"$variable=$value\" &gt;&gt; settings/volumes.rc.tmp<br> else<br> echo \"$variable=$answer\" &gt;&gt; settings/volumes.rc.tmp<br> fi<br> done<br> cp settings/volumes.rc settings/volumes.rc.previous<br> mv settings/volumes.rc.tmp settings/volumes.rc<br>fi</p>","metadata":{"starred":true}},{"id":"b79a90fc-7f54-415e-b3d7-34284c9d992e","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# export settings for envsusbtlines=$(cat settings/volumes.rc)for line in $linesdo export $linedone","_html":"<p># export settings for envsusbt<br>lines=$(cat settings/volumes.rc)<br>for line in $lines<br>do<br> export $line<br>done</p>","metadata":{"starred":true}},{"id":"d71d2fc9-c400-47b7-8f50-7525021dacda","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# build imagesecho \"[info] Building Image: ${IMAGE_NGINX_PROXY}\"docker build -t ${IMAGE_NGINX_PROXY} nginx-proxy","_html":"<p># build images<br>echo \"[info] Building Image: ${IMAGE_NGINX_PROXY}\"<br>docker build -t ${IMAGE_NGINX_PROXY} nginx-proxy</p>","metadata":{"starred":true}},{"id":"e880b4c4-f517-439d-883c-f5c0adf74f44","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Building Image: ${IMAGE_SONAR_POSTGRES}\"docker build -t ${IMAGE_SONAR_POSTGRES} sonarqube/postgres","_html":"<p>echo \"[info] Building Image: ${IMAGE_SONAR_POSTGRES}\"<br>docker build -t ${IMAGE_SONAR_POSTGRES} sonarqube/postgres</p>","metadata":{"starred":true}},{"id":"f8671966-c09d-48b4-a946-852e7619b537","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Building Image: ${IMAGE_SONARQUBE}\"docker build -t ${IMAGE_SONARQUBE} sonarqube/sonarqube","_html":"<p>echo \"[info] Building Image: ${IMAGE_SONARQUBE}\"<br>docker build -t ${IMAGE_SONARQUBE} sonarqube/sonarqube</p>","metadata":{"starred":true}},{"id":"9ff998c8-e11f-4b8d-b0c3-b00fd1abdcc6","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Building Image: ${IMAGE_ARTIFACTORY}\"docker build -t ${IMAGE_ARTIFACTORY} artifactory","_html":"<p>echo \"[info] Building Image: ${IMAGE_ARTIFACTORY}\"<br>docker build -t ${IMAGE_ARTIFACTORY} artifactory</p>","metadata":{"starred":true}},{"id":"d6d34c0f-b9f8-4882-b664-9e50c60fe156","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Building Image: ${IMAGE_JENKINS}\"docker build -t ${IMAGE_JENKINS} jenkins","_html":"<p>echo \"[info] Building Image: ${IMAGE_JENKINS}\"<br>docker build -t ${IMAGE_JENKINS} jenkins</p>","metadata":{"starred":true}},{"id":"86999459-e611-4fa9-828f-06c096ca4750","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# replace variables in docker-compose filecp docker-compose.yml docker-compose.yml.templateenvsubst < docker-compose.yml > docker-compose.yml.tmpmv docker-compose.yml.tmp docker-compose.yml# start infrastructuredocker-compose up -d# move defaults and backups into placeecho \"[info] backing up docker-compose.yml of this run to docker-compose.yml.previous\"cp docker-compose.yml docker-compose.yml.previousmv docker-compose.yml.template docker-compose.yml","_html":"<p># replace variables in docker-compose file<br>cp docker-compose.yml docker-compose.yml.template<br>envsubst &lt; docker-compose.yml &gt; docker-compose.yml.tmp<br>mv docker-compose.yml.tmp docker-compose.yml<br># start infrastructure<br>docker-compose up -d<br># move defaults and backups into place<br>echo \"[info] backing up docker-compose.yml of this run to docker-compose.yml.previous\"<br>cp docker-compose.yml docker-compose.yml.previous<br>mv docker-compose.yml.template docker-compose.yml</p>","metadata":{"starred":true}},{"id":"6e56d3fa-f984-42bd-bcf2-ae2fb8aa563f","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# push images to registryecho \"[info] Pushing Image: ${IMAGE_NGINX_PROXY}\"docker push ${IMAGE_NGINX_PROXY}","_html":"<p># push images to registry<br>echo \"[info] Pushing Image: ${IMAGE_NGINX_PROXY}\"<br>docker push ${IMAGE_NGINX_PROXY}</p>","metadata":{"starred":true}},{"id":"a9071f8e-a0fb-419c-bc1f-7a841e884172","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Pushing Image: ${IMAGE_SONAR_POSTGRES}\"docker push ${IMAGE_SONAR_POSTGRES}","_html":"<p>echo \"[info] Pushing Image: ${IMAGE_SONAR_POSTGRES}\"<br>docker push ${IMAGE_SONAR_POSTGRES}</p>","metadata":{"starred":true}},{"id":"6bfd43e2-3c8f-4664-bc54-9236bf670bae","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Pushing Image: ${IMAGE_SONARCUBE}\"docker push ${IMAGE_SONARCUBE}","_html":"<p>echo \"[info] Pushing Image: ${IMAGE_SONARCUBE}\"<br>docker push ${IMAGE_SONARCUBE}</p>","metadata":{"starred":true}},{"id":"b25c1a1f-2def-495c-9a28-e45416006d52","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Pushing Image: ${IMAGE_JENKINS}\"docker push ${IMAGE_JENKINS}","_html":"<p>echo \"[info] Pushing Image: ${IMAGE_JENKINS}\"<br>docker push ${IMAGE_JENKINS}</p>","metadata":{"starred":true}},{"id":"f525c868-edc5-431b-b576-ce95ae8c6618","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"echo \"[info] Pushing Image: ${IMAGE_ARTIFACTORY}\"docker push ${IMAGE_ARTIFACTORY}</pre>","_html":"<p>echo \"[info] Pushing Image: ${IMAGE_ARTIFACTORY}\"<br>docker push ${IMAGE_ARTIFACTORY}<br>&lt;/pre&gt;</p>","metadata":{"starred":true}},{"id":"81d41690-d6ce-49bf-9db3-76d85ddb5db2","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"You can look into the rest [here](https://simonopitz.me/content/images/2015/infrastructure.zip). I've packaged up all the whole scripts and stuff to get your build server up and running with just a few tweaks. Need help? Just tweet me at [@_sopitz](https://twitter.com/_sopitz). We at [eForce21](http://www.eforce21.com) love to help you.","_html":"<p>You can look into the rest [here](https://simonopitz.me/content/images/2015/infrastructure.zip). I've packaged up all the whole scripts and stuff to get your build server up and running with just a few tweaks. Need help? Just tweet me at [@_sopitz](https://twitter.com/_sopitz). We at [eForce21](http://www.eforce21.com) love to help you.</p>","metadata":{"starred":true}},{"id":"2e953934-0e5d-42cd-8250-f555f56775db","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# Gitlab with Google OAuthThat's what you need to do to get a Gitlab running with OAuth from Google.","_html":"<p># Gitlab with Google OAuth<br>That's what you need to do to get a Gitlab running with OAuth from Google.</p>","metadata":{"starred":true}},{"id":"8c8931b4-1a0b-4330-8670-b9a91b459c14","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"* Login to your [Google Developer Console](https://console.developers.google.com/) * create a new project, e. g. gitlab* configure the OAuth screen (APIs and authentication)* generate login data* configure Google-API","_html":"<p>* Login to your [Google Developer Console](https://console.developers.google.com/) <br>* create a new project, e. g. gitlab<br>* configure the OAuth screen (APIs and authentication)<br>* generate login data<br>* configure Google-API</p>","metadata":{"starred":true}},{"id":"6764ae4b-4a9e-4401-909e-c3c2a20b940a","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"I guess you want to secure the traffic to your Gitlab via SSL.","_html":"<p>I guess you want to secure the traffic to your Gitlab via SSL.</p>","metadata":{"starred":true}},{"id":"692e78dc-9be2-4472-89ab-86839ca0300d","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"<pre>mkdir -p /etc/nginx/sslcd /etc/nginx/sslopenssl genrsa -out your_domain.key 2048openssl req -new -x509 -key your_domain.key -out your_domain.crt -days 1095</pre>","_html":"<p>&lt;pre&gt;<br>mkdir -p /etc/nginx/ssl<br>cd /etc/nginx/ssl<br>openssl genrsa -out your_domain.key 2048<br>openssl req -new -x509 -key your_domain.key -out your_domain.crt -days 1095<br>&lt;/pre&gt;</p>","metadata":{"starred":true}},{"id":"8379c6ef-d73c-43d4-9750-aec7eced4379","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"You can also get a certificate from [Let's encrypt](http://letsencrypt.org). Let's Encrypt certificate handling will be covered by a blog post over at the [eForce21 Blog](http://www.eforce21.com/blog/).","_html":"<p>You can also get a certificate from [Let's encrypt](http://letsencrypt.org). Let's Encrypt certificate handling will be covered by a blog post over at the [eForce21 Blog](http://www.eforce21.com/blog/).</p>","metadata":{"starred":true}},{"id":"dae59280-f0fc-4388-931b-23fe9ce9c4e5","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"If you haven't started your nginx-proxy already with the setup I posted earlier, you should do that now.","_html":"<p>If you haven't started your nginx-proxy already with the setup I posted earlier, you should do that now.</p>","metadata":{"starred":true}},{"id":"6a63075d-4f5d-4c76-b1d8-68b363ac926d","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"<pre>docker run -d -v /etc/nginx/certs:/etc/nginx/certs -v /var/run/docker.sock:/tmp/docker.sock --security-opt=label:type:docker_t -p 80:80 -p 443:443 --name nginx-proxy jwilder/nginx-proxy</pre>","_html":"<p>&lt;pre&gt;<br>docker run -d -v /etc/nginx/certs:/etc/nginx/certs -v /var/run/docker.sock:/tmp/docker.sock --security-opt=label:type:docker_t -p 80:80 -p 443:443 --name nginx-proxy jwilder/nginx-proxy<br>&lt;/pre&gt;</p>","metadata":{"starred":true}},{"id":"d6d4efb9-0a3c-4070-a9cc-c4c5def00d2e","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"You only need one reverse proxy per IP. It will create name based virtual hosts for you and distribute the traffic to the appropriate applications.","_html":"<p>You only need one reverse proxy per IP. It will create name based virtual hosts for you and distribute the traffic to the appropriate applications.</p>","metadata":{"starred":true}},{"id":"720653fd-650f-4fe6-9c20-151fcb571424","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"Now we need to start Gitlab itself. We use `docker-compose`for this:<pre>postgresql: image: sameersbn/postgresql:9.4-3 environment: - DB_USER=gitlab_user - DB_PASS=gitlab_password - DB_NAME=gitlabdb volumes: - /var/lib/docker-data/gitlab/postgresql:/var/lib/postgresqlgitlab: image: sameersbn/gitlab:7.14.1 links: - redis:redisio - postgresql:postgresql ports: - \"2222:22” environment: - TZ=Europe/Berlin - GITLAB_TIMEZONE=Berlin - GITLAB_HTTPS=true - GITLAB_HOST=your_host - GITLAB_PORT=443 - GITLAB_SSH_PORT=2222 - GITLAB_EMAIL=your_email - GITLAB_EMAIL_REPLY_TO=your_email - VIRTUAL_HOST=git.dev.eforce21.com - OAUTH_GOOGLE_API_KEY=client_id - OAUTH_GOOGLE_APP_SECRET=client_key - OAUTH_GOOGLE_RESTRICT_DOMAIN=restrict_domain - OAUTH_ALLOW_SSO=true - OAUTH_BLOCK_AUTO_CREATED_USERS=false volumes: - /var/lib/docker-data/gitlab/gitlab:/home/git/dataredis: image: sameersbn/redis:latest volumes: - /var/lib/docker-data/gitlab/redis:/var/lib/redis</pre>","_html":"<p>Now we need to start Gitlab itself. We use `docker-compose`for this:<br>&lt;pre&gt;<br>postgresql:<br> image: sameersbn/postgresql:9.4-3<br> environment:<br> - DB_USER=gitlab_user<br> - DB_PASS=gitlab_password<br> - DB_NAME=gitlabdb<br> volumes:<br> - /var/lib/docker-data/gitlab/postgresql:/var/lib/postgresql<br>gitlab:<br> image: sameersbn/gitlab:7.14.1<br> links:<br> - redis:redisio<br> - postgresql:postgresql<br> ports:<br> - \"2222:22”<br> environment:<br> - TZ=Europe/Berlin<br> - GITLAB_TIMEZONE=Berlin<br> - GITLAB_HTTPS=true<br> - GITLAB_HOST=your_host<br> - GITLAB_PORT=443<br> - GITLAB_SSH_PORT=2222<br> - GITLAB_EMAIL=your_email<br> - GITLAB_EMAIL_REPLY_TO=your_email<br> - VIRTUAL_HOST=git.dev.eforce21.com<br> - OAUTH_GOOGLE_API_KEY=client_id<br> - OAUTH_GOOGLE_APP_SECRET=client_key<br> - OAUTH_GOOGLE_RESTRICT_DOMAIN=restrict_domain<br> - OAUTH_ALLOW_SSO=true<br> - OAUTH_BLOCK_AUTO_CREATED_USERS=false<br> volumes:<br> - /var/lib/docker-data/gitlab/gitlab:/home/git/data<br>redis:<br> image: sameersbn/redis:latest<br> volumes:<br> - /var/lib/docker-data/gitlab/redis:/var/lib/redis<br>&lt;/pre&gt;</p>","metadata":{"starred":true}},{"id":"5774b76d-f515-4497-b255-18299e72540f","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"And then start it with `docker-compose up -d`. Once it's started you can log in with the admin: root:5iveL!feYou will have to change that password after login.","_html":"<p>And then start it with `docker-compose up -d`. Once it's started you can log in with the admin: root:5iveL!fe<br>You will have to change that password after login.</p>","metadata":{"starred":true}},{"id":"b664cf9a-ace8-463a-a93f-e5d4ea168f39","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"# phensley/docker-dnsThat's what we sometimes use when we cannot use `docker-compose`. It will help you to achieve a name based linking system via DNS. Docker will only allow an IP based linking and that has proven to be not flexible enough at times. You will always have to restart more containers than necessary for your update and get that running with phensleys docker-dns container will make more complex setups without `docker-compose` very flexible.","_html":"<p># phensley/docker-dns<br>That's what we sometimes use when we cannot use `docker-compose`. It will help you to achieve a name based linking system via DNS. Docker will only allow an IP based linking and that has proven to be not flexible enough at times. You will always have to restart more containers than necessary for your update and get that running with phensleys docker-dns container will make more complex setups without `docker-compose` very flexible.</p>","metadata":{"starred":true}},{"id":"39b7429c-eac3-452b-957b-e5052bc81e6d","item":"25d49f46-3619-4d21-bdc8-be453c3b3bcc","type":"text","src":null,"created_at":"2016-08-03T15:17:05.592Z","updated_at":null,"_text":"Any comments or need help? Just tweet me at [@_sopitz](https://twitter.com/_sopitz). We at [eForce21](http://www.eforce21.com) love to help you.","_html":"<p>Any comments or need help? Just tweet me at [@_sopitz](https://twitter.com/_sopitz). We at [eForce21](http://www.eforce21.com) love to help you.</p>","metadata":{"starred":true}}]},"site-footer-item":{"id":"site-footer-item","index":3,"metadata":{"@type":"footer","starred":true},"content":[{"id":"site-footer-block","type":"footer","_html":"","metadata":{"starred":true},"footer":{"rss":{"href":"rss.xml","rel":"alternate","title":"Shining a light in IT RSS","type":"application/rss+xml"}}}]}},"sections":[{"componentId":"ArticleSiteHeaderFallback","itemsToRenderIds":["header-item-0"],"contracts":{"the-beautician":{"$item_index":1,"sectionsBeautyverse":{"section-height":{"$class":["section-height-fullscreen"]},"text-align":{"$class":["text-align-center"]},"group-order":{"$class":["group-order-normal"]},"group-graphical-shape":{"$class":["group-graphical-shape-none"]}},"$class":["group-graphical-shape-none","group-order-normal","text-align-center","section-height-fullscreen","site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col"]},"the-colorist":{"$item_index":1,"colorverse":{"colors-solution":{"color":"dark","$class":["colors-dark"]},"colors-locality":{"locality":"global","$class":["colors-global"]}},"$class":["colors-global","colors-dark","site:colors-global","site:colors-light"],"colorsSolution":{"isLight":false,"isDark":true,"lightnessClass":"is-dark","base":{"r":25,"g":25,"b":23},"bg":{"r":24,"g":24,"b":22},"box":{"r":25,"g":25,"b":23},"boxShadow":{"r":0,"g":0,"b":0,"a":0.3},"boxPop":{"r":100,"g":182,"b":172},"boxPopText":{"r":0,"g":0,"b":0},"boxPop2":{"r":41,"g":108,"b":103},"boxPop2Text":{"r":255,"g":255,"b":255},"boxPopTextHover":{"r":0,"g":0,"b":0},"boxPop2TextHover":{"r":204,"g":204,"b":204},"boxPopMostVibrant":{"r":54,"g":226,"b":206},"boxPopMostVibrantText":{"r":0,"g":0,"b":0},"selectionText":{"r":255,"g":255,"b":255},"selection":{"r":218,"g":71,"b":101,"a":0.5},"header":{"r":25,"g":25,"b":23},"zebraStripe":{"r":28,"g":28,"b":26},"line":{"r":42,"g":42,"b":40},"mediaBorder":{"css":"1px solid hsl(60, 2%, 16%)","width":1,"type":"solid","color":{"r":42,"g":42,"b":40}},"mediaShadowColor":{"r":0,"g":0,"b":0,"a":0.4},"mediaInsetColor":{"r":255,"g":255,"b":255,"a":0.1},"mediaShadows":[{"css":"0 1px 2px rgba(0, 0, 0, 0.4)","x":0,"y":1,"blur":2,"color":{"r":0,"g":0,"b":0,"a":0.4},"inset":false},{"css":"inset 0 1px 1px rgba(255, 255, 255, 0.1)","x":0,"y":1,"blur":1,"color":{"r":255,"g":255,"b":255,"a":0.1},"inset":true}],"title":{"r":220,"g":239,"b":237},"title2":{"r":162,"g":175,"b":173},"subTitle":{"r":90,"g":90,"b":89},"text":{"r":243,"g":243,"b":242},"text2":{"r":178,"g":178,"b":176},"textShadow":{"r":13,"g":13,"b":12,"a":0.5},"textShadowProps":{"color":{"r":13,"g":13,"b":12,"a":0.5},"x":0,"y":1,"blur":0},"textPop":{"r":225,"g":108,"b":132},"textPop2":{"r":145,"g":203,"b":196},"meta":{"r":90,"g":90,"b":89},"metaHover":{"r":103,"g":103,"b":101},"icon":{"r":225,"g":108,"b":132},"iconSelected":{"r":225,"g":108,"b":132},"iconOver":{"r":225,"g":108,"b":132},"palette":[{"r":255,"g":255,"b":255},{"r":25,"g":25,"b":23},{"r":41,"g":108,"b":103},{"r":100,"g":182,"b":172},{"r":218,"g":71,"b":101}]}},"the-lensman":{"filter":{"$class":["passthrough"],"graph":"passthrough","config":null}},"itemsClasses":["header-item-0","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay"],"siteClasses":["site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col","site:colors-global","site:colors-light"],"componentClasses":["ArticleSiteHeaderFallback"]},"sectionIndex":0},{"componentId":"ArticleHero","itemsToRenderIds":["25d49f46-3619-4d21-bdc8-be453c3b3bcc"],"contracts":{"the-beautician":{"$item_index":2,"sectionsBeautyverse":{"section-height":{"$class":["section-height-fullscreen"]},"text-align":{"$class":["text-align-center"]},"group-order":{"$class":["group-order-normal"]},"group-graphical-shape":{"$class":["group-graphical-shape-none"]}},"$class":["group-graphical-shape-none","group-order-normal","text-align-center","section-height-fullscreen","site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col"]},"the-colorist":{"$item_index":2,"colorverse":{"colors-solution":{"color":"dark","$class":["colors-dark"]},"colors-locality":{"locality":"local","$class":["colors-local"]}},"$class":["colors-local","colors-dark","site:colors-global","site:colors-light"],"colorsSolution":{"isLight":false,"isDark":true,"lightnessClass":"is-dark","base":{"r":36,"g":46,"b":55},"bg":{"r":22,"g":28,"b":34},"box":{"r":24,"g":31,"b":37},"boxShadow":{"r":0,"g":0,"b":0,"a":0.3},"boxPop":{"r":58,"g":154,"b":195},"boxPopText":{"r":0,"g":0,"b":0},"boxPop2":{"r":197,"g":78,"b":64},"boxPop2Text":{"r":255,"g":255,"b":255},"boxPopTextHover":{"r":0,"g":0,"b":0},"boxPop2TextHover":{"r":204,"g":204,"b":204},"boxPopMostVibrant":{"r":54,"g":146,"b":226},"boxPopMostVibrantText":{"r":255,"g":255,"b":255},"selectionText":{"r":255,"g":255,"b":255},"selection":{"r":54,"g":146,"b":226,"a":0.5},"header":{"r":23,"g":30,"b":36},"zebraStripe":{"r":27,"g":34,"b":40},"line":{"r":41,"g":47,"b":53},"mediaBorder":{"css":"1px solid hsl(210, 13%, 18%)","width":1,"type":"solid","color":{"r":41,"g":47,"b":53}},"mediaShadowColor":{"r":0,"g":0,"b":0,"a":0.4},"mediaInsetColor":{"r":255,"g":255,"b":255,"a":0.1},"mediaShadows":[{"css":"0 1px 2px rgba(0, 0, 0, 0.4)","x":0,"y":1,"blur":2,"color":{"r":0,"g":0,"b":0,"a":0.4},"inset":false},{"css":"inset 0 1px 1px rgba(255, 255, 255, 0.1)","x":0,"y":1,"blur":1,"color":{"r":255,"g":255,"b":255,"a":0.1},"inset":true}],"title":{"r":247,"g":238,"b":212},"title2":{"r":180,"g":176,"b":159},"subTitle":{"r":89,"g":95,"b":99},"text":{"r":240,"g":242,"b":245},"text2":{"r":175,"g":179,"b":183},"textShadow":{"r":12,"g":16,"b":19,"a":0.5},"textShadowProps":{"color":{"r":12,"g":16,"b":19,"a":0.5},"x":0,"y":1,"blur":0},"textPop":{"r":230,"g":197,"b":112},"textPop2":{"r":97,"g":174,"b":207},"meta":{"r":89,"g":95,"b":99},"metaHover":{"r":104,"g":111,"b":115},"icon":{"r":230,"g":197,"b":112},"iconSelected":{"r":230,"g":197,"b":112},"iconOver":{"r":230,"g":197,"b":112},"palette":[{"r":255,"g":255,"b":255},{"r":36,"g":46,"b":55},{"r":58,"g":154,"b":195},{"r":197,"g":78,"b":64},{"r":223,"g":182,"b":73}]}},"the-lensman":{"filter":{"$class":["insta_hefe"],"graph":"insta_hefe","config":null}},"itemsClasses":["25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res"],"siteClasses":["site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col","site:colors-global","site:colors-light"],"componentClasses":["ArticleHero"]},"sectionIndex":1}],"contracts":{"the-typographer":{"typography":{"fonts":{"display":{"normal":4,"bold":7,"$formality":-0.09090909090909094,"$type":["sans","grotesque"],"$weight":2,"$width":2,"$contrast":2,"family":"Karla","name":"Karla","foundry":"google","license":"ofl","similar_to":["apercu","ll circular","maison","maple","reader","relative","supria sans"],"description":"Karla is an open-source, grotesque sans-serif typeface designed by Jonathan Pinhorn. Karla isn’t perfect — the spacing is set a little wide and some of the kerning looks a little off, however, this font has tons of character and there really aren’t any other quirky grotesques like this that are available for free. Karla is available in two weights — normal and bold — each with matching italics."},"screen":{"normal":4,"bold":7,"$formality":-0.6363636363636364,"$type":["mono"],"$weight":2,"$width":2,"$contrast":2,"family":"Inconsolata","name":"Inconsolata","foundry":"google","license":"ofl","similar_to":["Akkurat Mono"],"description":"Inconsolata is an open-source monospaced typeface designed by Raph Levien. The design is humanist-inspired and takes cues from Avenir and Franklin Gothic according to the designer. It is a favorite programming font of many developers due to its crisp and clear on-screen rendering. Inconsolata includes a bold weight but without italics it’s not really appropriate for body copy."}},"styles":"html { font-family: '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } html.wf-active { font-family: 'Inconsolata', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } .wf-active .font-title, .wf-active .font-headline, .wf-active .font-h1, .wf-active .font-h2, .wf-active .font-h3 { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 700; } .wf-active .font-subtitle, .wf-active .font-h4, .wf-active .font-h5, .wf-active .font-h6 { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } .wf-active .font-text, .wf-active .font-list { font-family: 'Inconsolata', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif'; } .wf-active .font-quote { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400;font-style: italic; } .wf-active .font-cta { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif'; }","webfontconfig":{"google":{"families":["Karla:400,700","Inconsolata:400,400italic,700,700italic"]}}},"htmlStyleTagContent":"html { font-family: '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } html.wf-active { font-family: 'Inconsolata', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } .wf-active .font-title, .wf-active .font-headline, .wf-active .font-h1, .wf-active .font-h2, .wf-active .font-h3 { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 700; } .wf-active .font-subtitle, .wf-active .font-h4, .wf-active .font-h5, .wf-active .font-h6 { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400; } .wf-active .font-text, .wf-active .font-list { font-family: 'Inconsolata', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif'; } .wf-active .font-quote { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif';font-weight: 400;font-style: italic; } .wf-active .font-cta { font-family: 'Karla', '-apple-system', '.SFNSText-Regular', 'San Francisco', 'Roboto', 'Segoe UI', 'Helvetica Neue', 'Lucida Grande', 'sans-serif'; }","htmlScriptTagContent":"\n      if (window.WebFont) {\n        WebFont.load({\"google\":{\"families\":[\"Karla:400,700\",\"Inconsolata:400,400italic,700,700italic\"]}});\n      }\n    "},"the-beautician":{"$item_index":0,"siteBeautyverse":{"design-style":{"$class":["Brockmann"],"section":{"align":"t-a-c"},"title":{"color":""}},"section-h-padding":{"$class":["section-h-padding-small"]},"section-v-padding":{"$class":["section-v-padding-small"]},"hero-transition":{"$class":["hero-transition-none"]},"navigation-style":{"$class":["nav-left-column-style"],"css":"m-t-0 p-l-3 ls-p-l-4"}},"$class":["nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site:w-multiple-item","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col"]},"the-colorist":{"$item_index":0,"colorverse":{"colors-solution":{"color":"light","$class":["colors-light"]},"colors-locality":{"locality":"global","$class":["colors-global"]}},"$class":["colors-global","colors-light","site:w-multiple-item"],"colorsSolution":{"isLight":true,"isDark":false,"lightnessClass":"is-light","base":{"r":255,"g":255,"b":255},"bg":{"r":247,"g":247,"b":247},"box":{"r":255,"g":255,"b":255},"boxShadow":{"r":0,"g":0,"b":0,"a":0.1},"boxPop":{"r":41,"g":108,"b":103},"boxPopText":{"r":255,"g":255,"b":255},"boxPop2":{"r":100,"g":182,"b":172},"boxPop2Text":{"r":0,"g":0,"b":0},"boxPopTextHover":{"r":204,"g":204,"b":204},"boxPop2TextHover":{"r":0,"g":0,"b":0},"boxPopMostVibrant":{"r":54,"g":226,"b":206},"boxPopMostVibrantText":{"r":0,"g":0,"b":0},"selectionText":{"r":0,"g":0,"b":0},"selection":{"r":54,"g":226,"b":206,"a":0.5},"header":{"r":253,"g":253,"b":253},"zebraStripe":{"r":252,"g":252,"b":252},"line":{"r":238,"g":238,"b":238},"mediaBorder":{"css":"1px solid hsl(0, 0%, 93%)","width":1,"type":"solid","color":{"r":238,"g":238,"b":238}},"mediaShadowColor":{"r":0,"g":0,"b":0,"a":0.2},"mediaInsetColor":{"r":255,"g":255,"b":255,"a":0.1},"mediaShadows":[{"css":"0 1px 2px rgba(0, 0, 0, 0.2)","x":0,"y":1,"blur":2,"color":{"r":0,"g":0,"b":0,"a":0.2},"inset":false},{"css":"inset 0 1px 1px rgba(255, 255, 255, 0.1)","x":0,"y":1,"blur":1,"color":{"r":255,"g":255,"b":255,"a":0.1},"inset":true}],"title":{"r":28,"g":74,"b":71},"title2":{"r":96,"g":128,"b":126},"subTitle":{"r":186,"g":186,"b":185},"text":{"r":24,"g":24,"b":22},"text2":{"r":140,"g":140,"b":139},"textShadow":{"r":255,"g":255,"b":255,"a":0.5},"textShadowProps":{"color":{"r":255,"g":255,"b":255,"a":0.5},"x":0,"y":1,"blur":0},"textPop":{"r":185,"g":60,"b":86},"textPop2":{"r":41,"g":108,"b":103},"meta":{"r":186,"g":186,"b":185},"metaHover":{"r":159,"g":159,"b":157},"icon":{"r":185,"g":60,"b":86},"iconSelected":{"r":185,"g":60,"b":86},"iconOver":{"r":185,"g":60,"b":86},"palette":[{"r":255,"g":255,"b":255},{"r":25,"g":25,"b":23},{"r":41,"g":108,"b":103},{"r":100,"g":182,"b":172},{"r":218,"g":71,"b":101}]}}},"siteData":{"id":"ea864422-9b4b-4bbb-afe0-52fb58533664","ordered":true,"site":"the-domains/sopitz","title":"How do we use Docker? (Review Pt. 5)","navigable":false,"type":"permalink","siteUrl":"https://thegrid.ai/sopitz/","siteId":"736b52b7-bf3f-465b-b168-ca19b8e123b8","user":"f64ca813-26db-43f6-bc7f-f5457803101a","config":{"name":"uminoso Consultingl","title":"Shining a light in IT","style":"the-composer","favicon":"https://the-grid-user-content.s3-us-west-2.amazonaws.com/50d74ad9-19be-46ed-b7cb-955fdcb544c3.png","logo":"https://the-grid-user-content.s3-us-west-2.amazonaws.com/d10021f9-652c-4314-954b-0d6c5db83590.png","cta":{"bucket":null,"version":null,"domain":null},"analytics":{"twitter":null,"google":null,"facebook":null},"opengraph":{"image":null,"type":null,"appId":null},"collections":[{"index":{"path":"/","number":15,"paginate":true,"navigable":true},"permalink":{"path":"/:title/"},"feed":{"path":"/rss.xml","format":"rss","number":10}}],"color":{"saturation":0.8891937653534114,"brandStrength":0.7093041196931154,"lightness":0.5288254385814071,"brandColors":["#FFFFFF","#191917","#296C67","#64B6AC","#DA4765"],"rhythmicContrast":0.25332957901991904},"layout_spectrum":0.8293964678887278,"typography_spectrum":0.13897636346518993,"author":{"name":"Simon Oitzpw","email":"simon.opitz@luminoso-consulting.de","url":"luminoso-consulting.de"}},"navigation":[{"href":"index.html","title":"Shining a light in IT","rel":"home","type":"MainPage"}],"links":[{"href":"rss.xml","rel":"alternate","title":"Shining a light in IT RSS","type":"application/rss+xml"},{"href":"luminoso-consulting.de","rel":"me","title":"Simon Oitzpw","type":"text/html"}]},"navigation":{"componentId":"NavLeftColumn","itemsToRenderIds":["site-navigation-item"],"contracts":{"the-beautician":{"$item_index":0,"sectionsBeautyverse":{"section-height":{"$class":["section-height-fullscreen"]},"text-align":{"$class":["text-align-center"]},"group-order":{"$class":["group-order-normal"]},"group-graphical-shape":{"$class":["group-graphical-shape-circle"]}},"$class":["group-graphical-shape-circle","group-order-normal","text-align-center","section-height-fullscreen","site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col"]},"the-colorist":{"$item_index":0,"colorverse":{"colors-solution":{"color":"light","$class":["colors-light"]},"colors-locality":{"locality":"global","$class":["colors-global"]}},"$class":["colors-global","colors-light","site:colors-global","site:colors-light"],"colorsSolution":{"isLight":true,"isDark":false,"lightnessClass":"is-light","base":{"r":255,"g":255,"b":255},"bg":{"r":247,"g":247,"b":247},"box":{"r":255,"g":255,"b":255},"boxShadow":{"r":0,"g":0,"b":0,"a":0.1},"boxPop":{"r":41,"g":108,"b":103},"boxPopText":{"r":255,"g":255,"b":255},"boxPop2":{"r":100,"g":182,"b":172},"boxPop2Text":{"r":0,"g":0,"b":0},"boxPopTextHover":{"r":204,"g":204,"b":204},"boxPop2TextHover":{"r":0,"g":0,"b":0},"boxPopMostVibrant":{"r":54,"g":226,"b":206},"boxPopMostVibrantText":{"r":0,"g":0,"b":0},"selectionText":{"r":0,"g":0,"b":0},"selection":{"r":54,"g":226,"b":206,"a":0.5},"header":{"r":253,"g":253,"b":253},"zebraStripe":{"r":252,"g":252,"b":252},"line":{"r":238,"g":238,"b":238},"mediaBorder":{"css":"1px solid hsl(0, 0%, 93%)","width":1,"type":"solid","color":{"r":238,"g":238,"b":238}},"mediaShadowColor":{"r":0,"g":0,"b":0,"a":0.2},"mediaInsetColor":{"r":255,"g":255,"b":255,"a":0.1},"mediaShadows":[{"css":"0 1px 2px rgba(0, 0, 0, 0.2)","x":0,"y":1,"blur":2,"color":{"r":0,"g":0,"b":0,"a":0.2},"inset":false},{"css":"inset 0 1px 1px rgba(255, 255, 255, 0.1)","x":0,"y":1,"blur":1,"color":{"r":255,"g":255,"b":255,"a":0.1},"inset":true}],"title":{"r":28,"g":74,"b":71},"title2":{"r":96,"g":128,"b":126},"subTitle":{"r":186,"g":186,"b":185},"text":{"r":24,"g":24,"b":22},"text2":{"r":140,"g":140,"b":139},"textShadow":{"r":255,"g":255,"b":255,"a":0.5},"textShadowProps":{"color":{"r":255,"g":255,"b":255,"a":0.5},"x":0,"y":1,"blur":0},"textPop":{"r":185,"g":60,"b":86},"textPop2":{"r":41,"g":108,"b":103},"meta":{"r":186,"g":186,"b":185},"metaHover":{"r":159,"g":159,"b":157},"icon":{"r":185,"g":60,"b":86},"iconSelected":{"r":185,"g":60,"b":86},"iconOver":{"r":185,"g":60,"b":86},"palette":[{"r":255,"g":255,"b":255},{"r":25,"g":25,"b":23},{"r":41,"g":108,"b":103},{"r":100,"g":182,"b":172},{"r":218,"g":71,"b":101}]}},"the-lensman":{"filter":{"$class":["passthrough"],"graph":"passthrough","config":null}},"itemsClasses":["site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation"],"siteClasses":["site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col","site:colors-global","site:colors-light"],"componentClasses":["NavLeftColumn"]}},"footer":{"componentId":"Footer3col","itemsToRenderIds":["site-footer-item"],"contracts":{"the-beautician":{"$item_index":3,"sectionsBeautyverse":{"section-height":{"$class":["section-height-fullscreen"]},"text-align":{"$class":["text-align-center"]},"group-order":{"$class":["group-order-normal"]},"group-graphical-shape":{"$class":["group-graphical-shape-none"]}},"$class":["group-graphical-shape-none","group-order-normal","text-align-center","section-height-fullscreen","site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col"]},"the-colorist":{"$item_index":3,"colorverse":{"colors-solution":{"color":"dark","$class":["colors-dark"]},"colors-locality":{"locality":"global","$class":["colors-global"]}},"$class":["colors-global","colors-dark","site:colors-global","site:colors-light"],"colorsSolution":{"isLight":false,"isDark":true,"lightnessClass":"is-dark","base":{"r":25,"g":25,"b":23},"bg":{"r":24,"g":24,"b":22},"box":{"r":25,"g":25,"b":23},"boxShadow":{"r":0,"g":0,"b":0,"a":0.3},"boxPop":{"r":100,"g":182,"b":172},"boxPopText":{"r":0,"g":0,"b":0},"boxPop2":{"r":41,"g":108,"b":103},"boxPop2Text":{"r":255,"g":255,"b":255},"boxPopTextHover":{"r":0,"g":0,"b":0},"boxPop2TextHover":{"r":204,"g":204,"b":204},"boxPopMostVibrant":{"r":54,"g":226,"b":206},"boxPopMostVibrantText":{"r":0,"g":0,"b":0},"selectionText":{"r":255,"g":255,"b":255},"selection":{"r":218,"g":71,"b":101,"a":0.5},"header":{"r":25,"g":25,"b":23},"zebraStripe":{"r":28,"g":28,"b":26},"line":{"r":42,"g":42,"b":40},"mediaBorder":{"css":"1px solid hsl(60, 2%, 16%)","width":1,"type":"solid","color":{"r":42,"g":42,"b":40}},"mediaShadowColor":{"r":0,"g":0,"b":0,"a":0.4},"mediaInsetColor":{"r":255,"g":255,"b":255,"a":0.1},"mediaShadows":[{"css":"0 1px 2px rgba(0, 0, 0, 0.4)","x":0,"y":1,"blur":2,"color":{"r":0,"g":0,"b":0,"a":0.4},"inset":false},{"css":"inset 0 1px 1px rgba(255, 255, 255, 0.1)","x":0,"y":1,"blur":1,"color":{"r":255,"g":255,"b":255,"a":0.1},"inset":true}],"title":{"r":220,"g":239,"b":237},"title2":{"r":162,"g":175,"b":173},"subTitle":{"r":90,"g":90,"b":89},"text":{"r":243,"g":243,"b":242},"text2":{"r":178,"g":178,"b":176},"textShadow":{"r":13,"g":13,"b":12,"a":0.5},"textShadowProps":{"color":{"r":13,"g":13,"b":12,"a":0.5},"x":0,"y":1,"blur":0},"textPop":{"r":225,"g":108,"b":132},"textPop2":{"r":145,"g":203,"b":196},"meta":{"r":90,"g":90,"b":89},"metaHover":{"r":103,"g":103,"b":101},"icon":{"r":225,"g":108,"b":132},"iconSelected":{"r":225,"g":108,"b":132},"iconOver":{"r":225,"g":108,"b":132},"palette":[{"r":255,"g":255,"b":255},{"r":25,"g":25,"b":23},{"r":41,"g":108,"b":103},{"r":100,"g":182,"b":172},{"r":218,"g":71,"b":101}]}},"the-lensman":{"filter":{"$class":["passthrough"],"graph":"passthrough","config":null}},"itemsClasses":["site-footer-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-footer"],"siteClasses":["site:w-multiple-item","nav-left-column-style","hero-transition-none","section-v-padding-small","section-h-padding-small","Brockmann","site-navigation-item","item:can-cover-filter","item:can-cover-crop","item:can-cover-overlay","item:is-navigation","NavLeftColumn","header-item-0","ArticleSiteHeaderFallback","25d49f46-3619-4d21-bdc8-be453c3b3bcc","item:w-publisher","item:w-attribution","item:w-cover-face","item:w-cover-saliency","item:w-cover-landscape","item:w-cover-high-res","ArticleHero","site-footer-item","item:is-footer","Footer3col","site:colors-global","site:colors-light"],"componentClasses":["Footer3col"]}}}</script><script id="renderer" src="https://cdn.thegrid.io/design-systems/the-composer/ds-nj/v1.1.13/ds-renderer.js"></script><script id="web-font-loader">
      if (window.WebFont) {
        WebFont.load({"google":{"families":["Karla:400,700","Inconsolata:400,400italic,700,700italic"]}});
      }
    </script></body></html>